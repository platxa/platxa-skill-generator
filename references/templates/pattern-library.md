# Skill Pattern Library

Reusable patterns for common skill operations.

## Pattern Categories

| Category | Purpose | Examples |
|----------|---------|----------|
| Input | Gathering user input | Prompts, file selection |
| Processing | Data transformation | Parsing, filtering |
| Output | Presenting results | Tables, reports |
| Workflow | Multi-step processes | Wizards, pipelines |
| Error | Handling failures | Validation, recovery |

## Input Patterns

### Pattern: File Target Selection

```markdown
## Target Selection

Specify what to process:

**Single file:**
```
/skill-name path/to/file.ext
```

**Directory:**
```
/skill-name path/to/directory/
```

**Glob pattern:**
```
/skill-name "src/**/*.ts"
```

**Current context:**
```
/skill-name
```
(Uses currently open file or recent context)
```

### Pattern: Option Flags

```markdown
## Options

| Flag | Short | Description | Default |
|------|-------|-------------|---------|
| `--verbose` | `-v` | Detailed output | off |
| `--dry-run` | `-n` | Preview without changes | off |
| `--output` | `-o` | Output location | stdout |
| `--format` | `-f` | Output format | text |

**Examples:**
```
/skill-name --verbose path/to/file
/skill-name -o output.md --format markdown
```
```

### Pattern: Interactive Prompt

```markdown
## Configuration

I'll ask a few questions to customize the output:

1. **Target**: What should I process?
2. **Style**: How should results be formatted?
3. **Scope**: Full analysis or quick scan?

Or provide all options upfront:
```
/skill-name --target file.py --style detailed --scope full
```
```

## Processing Patterns

### Pattern: Multi-Step Pipeline

```markdown
## Processing Pipeline

### Step 1: Discovery
Scanning target for relevant items...
- Found: X files
- Types: Y, Z

### Step 2: Analysis
Processing each item...
- Analyzed: X/Y complete
- Issues: Z found

### Step 3: Generation
Creating output...
- Generated: X items
- Skipped: Y items

### Step 4: Verification
Validating results...
- Valid: X items
- Warnings: Y items
```

### Pattern: Progress Tracking

```markdown
## Progress

```
[████████░░░░░░░░] 45% Processing...
  Current: file-name.ext
  Completed: 23/50 files
  Elapsed: 1m 23s
  Remaining: ~1m 40s
```
```

### Pattern: Batch Processing

```markdown
## Batch Processing

Processing multiple items:

| Item | Status | Details |
|------|--------|---------|
| file1.py | ✓ Done | 3 functions documented |
| file2.py | ✓ Done | 1 class, 5 methods |
| file3.py | ⚠ Warning | Missing type hints |
| file4.py | ✗ Failed | Syntax error on line 42 |

**Summary:** 3/4 successful, 1 failed
```

## Output Patterns

### Pattern: Summary Report

```markdown
## Summary

═══════════════════════════════════════════════════
  ANALYSIS COMPLETE
═══════════════════════════════════════════════════

  Target: path/to/source
  Files: 24 analyzed
  Duration: 2.3 seconds

  Results:
    ✓ 18 passed
    ⚠ 4 warnings
    ✗ 2 errors

═══════════════════════════════════════════════════
```

### Pattern: Detailed Findings

```markdown
## Findings

### Critical Issues (2)

**1. Security: SQL Injection Risk**
- File: `src/db/queries.py:45`
- Issue: Unsanitized user input in query
- Fix: Use parameterized queries

**2. Bug: Null Reference**
- File: `src/handlers/user.py:123`
- Issue: Missing null check
- Fix: Add validation before access

### Warnings (4)

1. **Performance**: N+1 query in `get_users()` - line 67
2. **Style**: Line exceeds 120 characters - line 89
3. **Deprecated**: Using `old_function()` - line 102
4. **Missing**: No error handling in `save()` - line 45
```

### Pattern: Comparison Table

```markdown
## Comparison

| Aspect | Before | After | Change |
|--------|--------|-------|--------|
| Lines of code | 1,234 | 987 | -20% |
| Complexity | 45 | 32 | -29% |
| Test coverage | 65% | 82% | +17% |
| Dependencies | 12 | 8 | -33% |
```

### Pattern: Code Block Output

```markdown
## Generated Code

```python
# Generated by skill-name
# Target: path/to/file.py

def documented_function(arg1: str, arg2: int) -> bool:
    """Process the input and return success status.

    Args:
        arg1: Description of first argument.
        arg2: Description of second argument.

    Returns:
        True if processing succeeded, False otherwise.
    """
    # Implementation
    return True
```

**Copy this code** or I can write it directly to a file.
```

## Workflow Patterns

### Pattern: Wizard Flow

```markdown
## Setup Wizard

### Step 1 of 4: Project Type

What kind of project is this?

1. **Web Application** - Frontend/backend web app
2. **CLI Tool** - Command-line interface
3. **Library** - Reusable package
4. **API Service** - REST/GraphQL API

Enter choice [1-4]:
```

### Pattern: Confirmation Gate

```markdown
## Confirm Changes

The following changes will be made:

**Files to modify:**
- `src/config.py` - Add new settings
- `src/main.py` - Update imports

**Files to create:**
- `src/features/new_feature.py`
- `tests/test_new_feature.py`

**Estimated impact:** Low risk

Proceed with changes? [Y/n]
```

### Pattern: Iteration Loop

```markdown
## Refinement

Here's my first attempt:

[Generated content]

---

**Options:**
1. ✓ Accept this version
2. ↻ Regenerate with different approach
3. ✎ Modify specific parts
4. ✗ Cancel

What would you like to do?
```

## Error Patterns

### Pattern: Validation Error

```markdown
## Validation Error

✗ **Invalid Input**

The provided input doesn't meet requirements:

- ❌ File not found: `path/to/missing.py`
- ❌ Invalid format: Expected `.py`, got `.txt`
- ❌ Permission denied: Cannot read file

**How to fix:**
1. Check the file path exists
2. Ensure file has correct extension
3. Verify read permissions

Try again with: `/skill-name valid/path/file.py`
```

### Pattern: Graceful Degradation

```markdown
## Partial Results

⚠ **Completed with warnings**

Successfully processed 8/10 items.

**Skipped items:**
| Item | Reason |
|------|--------|
| file1.py | Syntax error |
| file2.py | Binary file |

**Available results** for successful items are shown below.
Would you like to:
1. View results for successful items
2. Fix issues and retry
3. Cancel
```

### Pattern: Recovery Suggestion

```markdown
## Error Recovery

The operation failed, but here are some options:

**What happened:**
Connection timeout while fetching remote data.

**Recovery options:**

1. **Retry** - Try the operation again
   ```
   /skill-name --retry
   ```

2. **Use cache** - Use previously cached data
   ```
   /skill-name --use-cache
   ```

3. **Offline mode** - Process without remote data
   ```
   /skill-name --offline
   ```
```

## Pattern Usage

```python
from enum import Enum

class PatternType(Enum):
    INPUT_FILE_TARGET = "input_file_target"
    INPUT_OPTIONS = "input_options"
    INPUT_INTERACTIVE = "input_interactive"
    PROCESS_PIPELINE = "process_pipeline"
    PROCESS_PROGRESS = "process_progress"
    PROCESS_BATCH = "process_batch"
    OUTPUT_SUMMARY = "output_summary"
    OUTPUT_DETAILED = "output_detailed"
    OUTPUT_TABLE = "output_table"
    OUTPUT_CODE = "output_code"
    WORKFLOW_WIZARD = "workflow_wizard"
    WORKFLOW_CONFIRM = "workflow_confirm"
    WORKFLOW_ITERATE = "workflow_iterate"
    ERROR_VALIDATION = "error_validation"
    ERROR_GRACEFUL = "error_graceful"
    ERROR_RECOVERY = "error_recovery"

def get_pattern(pattern_type: PatternType) -> str:
    """Get pattern template by type."""
    return PATTERN_TEMPLATES[pattern_type]
```
