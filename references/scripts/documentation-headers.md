# Script Documentation Headers

Standard documentation header patterns for skill scripts.

## Header Requirements

| Element | Required | Description |
|---------|----------|-------------|
| Shebang | Yes | Interpreter directive |
| Name | Yes | Script filename |
| Description | Yes | One-line purpose |
| Usage | Yes | How to invoke |
| Options | If any | Flag descriptions |
| Arguments | If any | Positional arg descriptions |
| Examples | Recommended | Common usage patterns |
| Author | Optional | Creator info |
| Version | Optional | Script version |

## Bash Header Template

```bash
#!/bin/bash
# script-name.sh - One-line description of what this script does
#
# Usage: script-name.sh [OPTIONS] <input-file> [output-file]
#
# Arguments:
#   input-file     Path to input file (required)
#   output-file    Path to output file (optional, default: stdout)
#
# Options:
#   -h, --help     Show this help message and exit
#   -v, --verbose  Enable verbose output
#   -n, --dry-run  Preview without making changes
#   -o, --output   Specify output path
#   -f, --format   Output format: md, html, json (default: md)
#
# Examples:
#   script-name.sh input.txt
#   script-name.sh --verbose input.txt output.md
#   script-name.sh -f json input.txt > output.json
#
# Environment:
#   SCRIPT_DEBUG   Set to 1 for debug output
#   OUTPUT_DIR     Default output directory
#
# Exit codes:
#   0  Success
#   1  General error
#   2  Invalid arguments
#   3  Input file not found
#
# Author: Generated by platxa-skill-generator
# Version: 1.0.0
```

## Python Header Template

```python
#!/usr/bin/env python3
"""Script name - One-line description of what this script does.

This script performs [detailed description of functionality].
It can be used for [primary use cases].

Usage:
    script_name.py [OPTIONS] <input_file> [output_file]

Arguments:
    input_file     Path to input file (required)
    output_file    Path to output file (optional, default: stdout)

Options:
    -h, --help     Show this help message and exit
    -v, --verbose  Enable verbose output
    -n, --dry-run  Preview without making changes
    -o, --output   Specify output path
    -f, --format   Output format: md, html, json (default: md)

Examples:
    $ script_name.py input.txt
    $ script_name.py --verbose input.txt output.md
    $ script_name.py -f json input.txt > output.json

Environment Variables:
    SCRIPT_DEBUG   Set to '1' for debug output
    OUTPUT_DIR     Default output directory

Exit Codes:
    0: Success
    1: General error
    2: Invalid arguments
    3: Input file not found

Author: Generated by platxa-skill-generator
Version: 1.0.0
"""
```

## Header Generator

```python
from dataclasses import dataclass
from typing import Literal

@dataclass
class ScriptHeader:
    name: str
    description: str
    usage: str
    arguments: list[tuple[str, str]]  # (name, description)
    options: list[tuple[str, str, str]]  # (short, long, description)
    examples: list[str]
    env_vars: list[tuple[str, str]]  # (name, description)
    exit_codes: list[tuple[int, str]]  # (code, description)
    author: str | None
    version: str

def generate_bash_header(header: ScriptHeader) -> str:
    """Generate bash script documentation header."""
    lines = [
        "#!/bin/bash",
        f"# {header.name} - {header.description}",
        "#",
        f"# Usage: {header.usage}",
        "#"
    ]

    # Arguments
    if header.arguments:
        lines.append("# Arguments:")
        for name, desc in header.arguments:
            lines.append(f"#   {name:<14} {desc}")
        lines.append("#")

    # Options
    if header.options:
        lines.append("# Options:")
        for short, long, desc in header.options:
            flag = f"{short}, {long}" if short else f"    {long}"
            lines.append(f"#   {flag:<14} {desc}")
        lines.append("#")

    # Examples
    if header.examples:
        lines.append("# Examples:")
        for example in header.examples:
            lines.append(f"#   {example}")
        lines.append("#")

    # Environment variables
    if header.env_vars:
        lines.append("# Environment:")
        for name, desc in header.env_vars:
            lines.append(f"#   {name:<14} {desc}")
        lines.append("#")

    # Exit codes
    if header.exit_codes:
        lines.append("# Exit codes:")
        for code, desc in header.exit_codes:
            lines.append(f"#   {code}  {desc}")
        lines.append("#")

    # Metadata
    if header.author:
        lines.append(f"# Author: {header.author}")
    lines.append(f"# Version: {header.version}")

    return "\n".join(lines)

def generate_python_header(header: ScriptHeader) -> str:
    """Generate Python script documentation header."""
    lines = [
        "#!/usr/bin/env python3",
        f'"""{header.name} - {header.description}',
        "",
        "Usage:",
        f"    {header.usage}",
        ""
    ]

    # Arguments
    if header.arguments:
        lines.append("Arguments:")
        for name, desc in header.arguments:
            lines.append(f"    {name:<14} {desc}")
        lines.append("")

    # Options
    if header.options:
        lines.append("Options:")
        for short, long, desc in header.options:
            flag = f"{short}, {long}" if short else f"    {long}"
            lines.append(f"    {flag:<14} {desc}")
        lines.append("")

    # Examples
    if header.examples:
        lines.append("Examples:")
        for example in header.examples:
            lines.append(f"    $ {example}")
        lines.append("")

    # Environment variables
    if header.env_vars:
        lines.append("Environment Variables:")
        for name, desc in header.env_vars:
            lines.append(f"    {name:<14} {desc}")
        lines.append("")

    # Exit codes
    if header.exit_codes:
        lines.append("Exit Codes:")
        for code, desc in header.exit_codes:
            lines.append(f"    {code}: {desc}")
        lines.append("")

    # Metadata
    if header.author:
        lines.append(f"Author: {header.author}")
    lines.append(f"Version: {header.version}")
    lines.append('"""')

    return "\n".join(lines)
```

## Default Headers by Script Type

```python
DEFAULT_HEADERS = {
    "generate.sh": ScriptHeader(
        name="generate.sh",
        description="Generate output using this skill",
        usage="generate.sh [OPTIONS] <input>",
        arguments=[("input", "Input file or directory")],
        options=[
            ("-h", "--help", "Show help"),
            ("-v", "--verbose", "Verbose output"),
            ("-o", "--output", "Output path"),
            ("-n", "--dry-run", "Preview only"),
        ],
        examples=[
            "generate.sh input.txt",
            "generate.sh --output result.md input.txt",
        ],
        env_vars=[],
        exit_codes=[(0, "Success"), (1, "Error")],
        author="Generated by platxa-skill-generator",
        version="1.0.0"
    ),

    "validate.sh": ScriptHeader(
        name="validate.sh",
        description="Validate input or output files",
        usage="validate.sh [OPTIONS] <file>",
        arguments=[("file", "File to validate")],
        options=[
            ("-h", "--help", "Show help"),
            ("-v", "--verbose", "Verbose output"),
            ("-q", "--quiet", "Only show errors"),
            ("", "--strict", "Fail on warnings"),
        ],
        examples=[
            "validate.sh output.md",
            "validate.sh --strict output.md",
        ],
        env_vars=[],
        exit_codes=[
            (0, "Valid"),
            (1, "Invalid"),
            (2, "Warnings (with --strict)"),
        ],
        author="Generated by platxa-skill-generator",
        version="1.0.0"
    ),
}
```

## Header Validation

```python
def validate_header(
    script_path: str,
    content: str
) -> list[str]:
    """Validate script has proper documentation header."""
    errors = []
    lines = content.split("\n")

    # Check shebang
    if not lines or not lines[0].startswith("#!"):
        errors.append("Missing shebang line")

    # Check for description comment
    has_description = False
    has_usage = False
    has_options = False

    for i, line in enumerate(lines[:30]):  # Check first 30 lines
        if script_path.endswith(".sh"):
            if line.startswith("# ") and " - " in line and i < 5:
                has_description = True
            if "# Usage:" in line or "# usage:" in line:
                has_usage = True
            if "# Options:" in line or "# options:" in line:
                has_options = True
        elif script_path.endswith(".py"):
            if '"""' in line or "'''" in line:
                # In docstring
                has_description = True
            if "Usage:" in line:
                has_usage = True
            if "Options:" in line:
                has_options = True

    if not has_description:
        errors.append("Missing description in header")
    if not has_usage:
        errors.append("Missing Usage section in header")

    return errors
```

## Extraction for --help

```bash
# Extract header comments for --help output
usage() {
    # Extract lines starting with "# " up to first blank comment or code
    sed -n '2,/^[^#]/p' "$0" | sed 's/^# \?//' | head -n -1
    exit 0
}
```

```python
def get_help_from_docstring() -> str:
    """Extract help text from module docstring."""
    import sys
    return sys.modules[__name__].__doc__ or ""
```
